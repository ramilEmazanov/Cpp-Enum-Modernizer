## **Автор**

**ФИО:** Рамазанов Эмиль Аликович

**Группа:** М3100

---

# **Название проекта**

**C++ Enum Modernizer — плагин для VS Code**

Плагин для автоматического преобразования устаревших `enum` в современные `enum class` а также преобразованием имён полей под Google C++ Style Guide.

---

# **Описание проекта**

Проект представляет собой расширение для Visual Studio Code, выполняющее автоматическую переработку перечислений (`enum`) в C++.

Плагин анализирует содержимое файла, преобразует устаревшие перечисления в формат `enum class`, приводит имена полей к стилю `kPascalCase`.

---

# **Задача (ТЗ)**

1. Реализовать плагин для VS Code, который:

   * Находит перечисления `enum` в коде C++.
   * Преобразует их в `enum class`.
   * Приводит имена полей перечисления к формату `kPascalCase` (Google C++ Style).
   * Сохраняет имена, которые уже начинаются с `k` — они не изменяются.

2. Создать архитектурную схему (блок-схему) обработки текста.
3. Реализовать исходный код плагина.
4. Загрузить проект на GitHub.
5. Оформить документацию и отчёт согласно требованиям.

---

# **Возможности плагина**

### Преобразование синтаксиса

* `enum` → `enum class`

### Переименование полей перечисления

* `RED_VALUE` → `kRedValue`
* `blue` → `kBlue`
* `someValue` → `kSomeValue`
* `kAlreadyGood` → остаётся без изменений

### Автоматическое обновление кода

До:

```cpp
enum Color {
    red,
    Blue
};
```

После:

```cpp
enum class Color {
    kRed,
    kBlue
};
```

### Работа на всём файле или выделенной области

Если выделения нет — обрабатывается весь документ.

---

# **Архитектура плагина**

Плагин имеет однопроходную архитектуру обработки текста:

## **Блок-схема**

```
 ┌──────────────────────────────────────────┐
 │             Старт команды                │
 └──────────────────────────────────────────┘
                    │
                    ▼
        ┌─────────────────────────┐
        │ Чтение текста файла     │
        └─────────────────────────┘
                    │
                    ▼
     ┌────────────────────────────────┐
     │ Проход №1:                     │
     │ - поиск enum                   │
     │ - преобразование в enum class  │
     │ - генерация kStyle имён        │
     │ - построение карты замен       │
     └────────────────────────────────┘
                    │
                    ▼
       ┌────────────────────────────┐
       │ Запись изменений в редактор│
       └────────────────────────────┘
                    │
                    ▼
         ┌──────────────────────┐
         │       Конец          │
         └──────────────────────┘
```

---

# **Установка**

## Вариант 1: через VSIX

1. Собрать расширение:

   ```bash
   vsce package
   ```
2. В VS Code:

   * Открыть вкладку Extensions
   * Нажать `...`
   * Выбрать **Install from VSIX...**

## Вариант 2: запуск в режиме разработки

1. Открыть проект в VS Code
2. Нажать **F5**
3. Откроется отдельное окно "Extension Development Host"

---

# **Структура проекта**

```
cpp-enum-modernizer/
│
├── extension.js          # основной код плагина
├── package.json          # описание расширения
├── README.md             # документация
```

---

# **Документация кода**


## **1. `toKStyle(name)`**

Назначение: преобразование имени константы enum в стиль `kPascalCase`.

### Логика:

1. Если строка пустая → вернуть как есть.
2. Если имя уже начинается с `k` (проверка `/^\s*k/`) → вернуть как есть.
3. Разбитие имени:

   * вставляет пробел между camelCase-стыками:
     `([a-z0-9])([A-Z]) → $1 $2`
   * заменяет `_`, `-`, `.`, пробелы на единственный пробел.
4. Каждую часть приводит к виду `PascalCase`.
5. Соединяет части и добавляет `k` в начало.

---

## **2. `transformEnumBody(body, enumName)`**

Назначение: преобразует содержимое `{ ... }` перечисления.

### Алгоритм:

1. Делит элементы перечисления по `,`.
2. Для каждого элемента:

   * тримминг,
   * парсинг через RegExp:
     `^([A-Za-z_]\w*)(\s*=\s*[^\/,]+)?(.*)$`, где
     • группа 1 — имя,
     • группа 2 — инициалайзер `= ...`,
     • группа 3 — оставшаяся часть (комментарии и т. д.).
3. Имя преобразуется через `toKStyle`, если не начинается с `k`.
4. Сборка элементов обратно с тем же хвостом и инициализатором.
5. Возвращает тело в формате:

   ```
   {
       item1,
       item2,
       ...
   }
   ```

---

## **3. `transformEnumBlock(fullMatch, enumKw, afterEnum, enumName, body)`**

Назначение: преобразует один блок `enum ... { ... }`.

### Логика:

1. Проверяет, указан ли уже `enum class` или `enum struct`:

   * поиск `\bclass\b` в `afterEnum`.
2. Обрабатывает тело через `transformEnumBody`.
3. Если `enum` не содержит `class`:

   * заменяет `enum` → `enum class`.
4. Далее заменяет существующее `{ ... }` на новое тело.

Возвращает преобразованный кусок текста.

---

## **4. `processText(text)`**

Назначение: обрабатывает весь документ или выделение.

### Используется RegExp:

```
\b(enum)\b(\s+(?:class|struct))?\s+(\w+)?\s*\{([\s\S]*?)\}
```

Группы:

1. ключевое слово `enum`,
2. `class` или `struct` (опционально),
3. имя перечисления,
4. тело `{...}`.

Каждое совпадение передаётся в `transformEnumBlock`.

---

## **5. VS Code Extension API: `activate(context)`**

Назначение: регистрация команды расширения.

### Действие команды `extension.enumsToEnumClassKStyle`:

1. Получает текст:

   * либо выделение,
   * либо весь документ.
2. Применяет `processText`.~
3. Если изменения есть — заменяет текст через `editor.edit()`.

---


# **Краткая схема работы**

```
activate()
    ↳ registerCommand
        ↳ processText(source)
            ↳ transformEnumBlock()  // для каждого найденного enum
                ↳ transformEnumBody()
                    ↳ toKStyle()
```

---


Также в проекте используются комментарии формата JSDoc, позволяющие:

* документировать функции;
* описывать параметры и возвращаемые значения;

